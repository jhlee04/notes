import win32com.client

# PowerPoint 열기
ppt_app = win32com.client.Dispatch("PowerPoint.Application")
ppt_app.Visible = True  # (Optional) PowerPoint 창 보이게

# 파일 열기
presentation = ppt_app.Presentations.Open(r"C:\path\to\your_file.pptx", WithWindow=False)

for slide_idx, slide in enumerate(presentation.Slides):
    print(f"\n===== Slide {slide_idx + 1} =====")
    
    for shape_idx, shape in enumerate(slide.Shapes):
        if shape.HasTable:
            table = shape.Table
            rows = table.Rows.Count
            cols = table.Columns.Count
            print(f"  ➤ Table found in shape {shape_idx + 1} ({rows}x{cols})")
            
            for row in range(1, rows + 1):
                for col in range(1, cols + 1):
                    cell_text = table.Cell(row, col).Shape.TextFrame.TextRange.Text.strip()
                    if cell_text:
                        print(f"    - Cell[{row-1}, {col-1}] : {cell_text}")

# 종료 (선택)
# presentation.Close()
# ppt_app.Quit()
